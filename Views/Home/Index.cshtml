@using System.Net
@using Newtonsoft.Json
@using nuelranks.pustalorc.xyz.JSON_Classes
@{
    ViewData["Title"] = "Home page";
}

<div class="text-center">
    <h1 class="display-4">The Nuel Rainbow 6 Siege Ranks</h1>
    <br/>
    <ul class="list-group">
        @{
            using (var web = new WebClient())
            {
                foreach (var team in JsonConvert.DeserializeObject<List<SimpleTeam>>(web.DownloadString("https://api.pustalorc.xyz/NuelTeams")))
                {
                    <li class="list-group-item">
                        Team: <a href="https://thenuel.com/team/@team.Id?gameContext=5734">@team.Name</a> - Total MMR: @team.TotalMMR - Average MMR: @team.AverageMMR
                        <ul class="list-group-horizontal">
                            @{
                                foreach (var player in team.Members)
                                {
                                    if (string.IsNullOrEmpty(player.ProfilePicture))
                                    {
                                        <li class="list-group-item-warning">@player.Name - Account doesn't exist, please verify your name.</li>
                                    }
                                    else
                                    {
                                        <li class="list-group-item">
                                            <a href="https://r6.tracker.network/profile/pc/@player.Name"><img class="player-image" src="@player.ProfilePicture" alt="@player.ProfilePicture" /></a>
                                            <p>UPlay Name: @player.Name</p>
                                            <p>Current MMR: @player.MMR</p>
                                            <p>Current Rank: <img class="player-rank" src="@player.Rank" alt="@player.Rank" /></p>
                                        </li>
                                    }
                                }
                            }
                        </ul>
                    </li>
                }
            }
        }
    </ul>
    <br/>
</div>
@using System.Net
@using Newtonsoft.Json
@using nuelranks.pustalorc.xyz.JSON_Classes
@{
    ViewData["Title"] = "The Nuel League Of Legends Ranks";
}

<div class="text-center">
    <h1 class="display-4"><a href="https://tournaments.thenuel.com/tournaments/league-of-legends-university-series-south-winter-2019">The Nuel League Of Legends</a> Ranks</h1>
    <br/>
    @{
        using (var web = new WebClient())
        {
            var teams = JsonConvert.DeserializeObject<List<LeagueOfLegendsTeam>>(web.DownloadString("https://api.pustalorc.xyz/NuelTeams/LeagueOfLegends"));

            for (var i = 0; i <= teams.Count / 6; i++)
            {
                <div class="row">
                    <div class="col-auto mx-auto">
                        <ul class="list-group list-group-horizontal">
                            @{
                                for (var o = 0; o < 6; o++)
                                {
                                    var index = o + i * 6;
                                    if (index < teams.Count)
                                    {
                                        <li class="list-group-item border-0">
                                            @{
                                                var team = teams[index];
                                                var captain = team?.Members?.FirstOrDefault(k => k.IsCaptain)?.ProfileIconId ?? 0;
                                                var image = $"http://ddragon.leagueoflegends.com/cdn/9.20.1/img/profileicon/{captain}.png";
                                                var rankUrl = $"https://opgg-static.akamaized.net/images/medals/{team.AverageRank.ToLower()}.png";

                                                <a href="/LoL/@team.Id">
                                                    <img class="player-image" src="@image" alt="@team.Name"/>
                                                </a>
                                                <p>@team.Name</p>
                                                <p>Team Rank: <img class="player-rank" src="@rankUrl" alt="@team.AverageRank"/></p>
                                            }
                                        </li>
                                    }
                                }
                            }
                        </ul>
                    </div>
                </div>
            }
        }
    }
</div>